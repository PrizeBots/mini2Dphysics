<canvas id=a width=1500 height=900></canvas>
<script>
c = a.getContext('2d');

M=(b,d=30*Math.random()+10,M=1/d)=>g.push({C:b,I:0,V:o(0,0),M:M,A:o(0,M?250:0),B:M?7*Math.random():0,D:0,E:0,R:d,Z:String.fromCodePoint(128512+69*Math.random()|0)}),o=(b,d,M)=>({x:b,y:d}),r=(b,d,M)=>y(b,b)**.5,e=(b,d,M)=>o(b.x+d.x,b.y+d.y),C=(b,d,M)=>e(b,V(d,-1)),V=(b,d,M)=>o(b.x*d,b.y*d),y=(b,d,M)=>b.x*d.x+b.y*d.y,R=(b,d,M)=>b.x*d.y-b.y*d.x,f=(b,d,M)=>V(b,1/(r(b)||1)),g=[];for(M(o(800,1e3),600,0),i=99;i--;)M(o(900*Math.random()+300,900*Math.random()-700));onclick=(b=>M(o(b.pageX,b.pageY))),setInterval(M=>{for(a.width^=0,i=g.length;i--;){for(j=g.length;j-->i;)b=g[i],d=g[j],M=C(d.C,b.C),r(M)<b.R+d.R&&(D=b.R+d.R-r(M),N=f(M),S=e(d.C,V(f(V(M,-1)),d.R)),E=e(S,V(N,D)),(b.M||d.M)&&(h=V(N,D/(b.M+d.M)*.8),b.C=e(b.C,V(h,-b.M)),d.C=e(d.C,V(h,d.M)),p=e(V(S,d.M/(b.M+d.M)),V(E,b.M/(b.M+d.M))),l=C(p,b.C),m=C(p,d.C),n=C(e(d.V,o(-1*d.D*m.y,d.D*m.x)),e(b.V,o(-1*b.D*l.y,b.D*l.x))),s=-1.5*y(n,N)/(b.M+d.M+R(l,N)**2*b.M+R(m,N)**2*d.M),t=V(N,s),b.V=C(b.V,V(t,b.M)),d.V=e(d.V,V(t,d.M)),b.D-=R(l,N)*s*b.M,d.D+=R(m,N)*s*d.M,u=V(f(C(n,V(N,y(n,N)))),-1),x=-1.5*y(n,u)*.5/(b.M+d.M+R(l,u)**2*b.M+R(m,u)**2*d.M),t=V(u,x),b.V=C(b.V,V(t,b.M)),d.V=e(d.V,V(t,d.M)),b.D-=R(l,u)*x*b.M,d.D+=R(m,u)*x*d.M));b.V=e(b.V,V(b.A,.01)),b.C=e(b.C,V(b.V,.01)),b.D+=.01*b.E,b.B+=b.M?.01*b.D:.001,c.save(),c.beginPath(),c.translate(b.C.x,b.C.y),c.rotate(b.B),c.arc(0,0,b.R,0,7),c.font=1.9*b.R+"px a",g[i].M?c.fillText(b.Z,1.24*-b.R,.67*b.R):c.fill(),c.restore()}},9)

</script>
